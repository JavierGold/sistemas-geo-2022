<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <title>Pr√°ctica 4 2P</title>

        <style>
            #map,
            html,
            body {
                width: 100%;
                height: 100%;
            }

            html,
            body {
                margin: 0;
                padding: 0;
            }

            p {
                margin-bottom: 0;
                padding-bottom: 0;
            }
        </style>
    </head>
    <body>

        <div id="map"></div>

        <script>
            var coordinates = {
                lat: 0,
                lng: 0
            };

            var props = {
                center: coordinates,
                zoom: 2
            };

            var icon = {
                url: "https://www.pngall.com/wp-content/uploads/2017/05/Map-Marker-Free-Download-PNG.png",
                scaledSize: new google.maps.Size(50, 50),
                origin: new google.maps.Point(0, 0),
                anchor: new google.maps.Point(0, 0)
            };

            function iniciaMapa() {

                fetch("paises.json")
                .then(function(response) {
                    response.json().then(function(data) {
                        console.log(data);
                        const map = new google.maps.Map(document.getElementById('map'), props);

                        data.forEach(element => {
                            console.log(element);
                            var info = `
                                <p>Country: ${element.CountryName}</p>
                                <p>Capital: ${element.CapitalName}</p>
                            `;
                            var infoWindow = new google.maps.InfoWindow({
                                content: info
                            });

                            let marker = new google.maps.Marker({
                                map: map,
                                position: new google.maps.LatLng(element.CapitalLatitude, element.CapitalLongitude),
                                title: element.CountryName,
                                icon: icon
                            });

                            marker.addListener('click', function() {
                                infoWindow.open(map, marker);
                            });
                        });
                    });
                })
                .catch(function(error) {
                    console.log("An error has occurred while fetching data... " + error.message);
                });
            }
        </script>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCMrQgga-C5zCuZLTVk2MPVzX7naqKZXZU&callback=iniciaMapa" async defer></script>
    </body>
</html>